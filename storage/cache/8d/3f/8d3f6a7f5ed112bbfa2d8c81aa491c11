9999999999s:27013:"System.register("flagrow/bazaar/addBazaarPage",["flarum/extend","flarum/app","flarum/components/AdminNav","flarum/components/AdminLinkButton","flagrow/bazaar/components/BazaarPage"],function(g,l){var a,c,d,b,e;g("default",function(){c.routes["flagrow-bazaar"]={path:"/flagrow/bazaar",component:e.component()};a(d.prototype,"items",function(a){a.add("flagrow-bazaar",b.component({href:c.route("flagrow-bazaar"),icon:"shopping-bag",children:c.translator.trans("flagrow-bazaar.admin.nav.title"),description:c.translator.trans("flagrow-bazaar.admin.nav.description")}))})});
return{setters:[function(b){a=b.extend},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]}],execute:function(){}}});"use strict";
System.register("flagrow/bazaar/addTasksPage",["flarum/extend","flarum/app","flagrow/bazaar/components/TasksPage"],function(g,l){var a,c;g("default",function(){a.routes["flagrow-bazaar-tasks"]={path:"/flagrow/bazaar/tasks",component:c.component()}});return{setters:[function(a){},function(d){a=d["default"]},function(a){c=a["default"]}],execute:function(){}}});"use strict";
System.register("flagrow/bazaar/components/BazaarLoader",["flarum/Component","flarum/helpers/icon"],function(g,l){var a,c,d;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]}],execute:function(){d=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);babelHelpers.createClass(b,[{key:"view",value:function(){return m("div",{className:"Bazaar--Loader",
hidden:!this.props.loading()},[m("div",[c("shopping-cart"),m("span",[app.translator.trans("flagrow-bazaar.admin.loader.is_loading")])])])}}]);return b}(a);g("default",d)}}});"use strict";
System.register("flagrow/bazaar/components/BazaarPage","flarum/Component flagrow/bazaar/utils/ExtensionRepository flagrow/bazaar/components/ExtensionListItem flagrow/bazaar/components/BazaarLoader flagrow/bazaar/components/BazaarPageHeader flagrow/bazaar/components/CustomCheckbox".split(" "),function(g,l){var a,c,d,b,e,h,f;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]}],
execute:function(){f=function(a){function k(){babelHelpers.classCallCheck(this,k);return babelHelpers.possibleConstructorReturn(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}babelHelpers.inherits(k,a);babelHelpers.createClass(k,[{key:"init",value:function(){app.current=this;this.loading=m.prop(!1);this.repository=m.prop(new c(this.loading));this.repository().loadNextPage();this.connected=1==app.data.settings["flagrow.bazaar.connected"]||!1}},{key:"view",value:function(){return m("div",
{className:"ExtensionsPage Bazaar"},[e.component({connected:this.connected}),m("div",{className:"ExtensionsPage-list"},[m("div",{className:"container"},[this.search(),this.items()])]),b.component({loading:this.loading})])}},{key:"search",value:function(){var a=this;return m("fieldset.ExtensionSearch",[h.component({iconChecked:"toggle-up",state:this.repository().filterUpdateRequired(),onchange:function(b){return a.repository().filterUpdateRequired(b)},children:app.translator.trans("flagrow-bazaar.admin.search.filter_update_required")}),
h.component({iconChecked:"plus-square",state:this.repository().filterInstalled(),onchange:function(b){return a.repository().filterInstalled(b)},children:app.translator.trans("flagrow-bazaar.admin.search.filter_installed")}),this.connected?h.component({iconChecked:"heart",state:this.repository().filterFavorited(),onchange:function(b){return a.repository().filterFavorited(b)},children:app.translator.trans("flagrow-bazaar.admin.search.filter_favorites")}):""])}},{key:"items",value:function(){var a=this;
return m("ul",{className:"ExtensionList"},[this.repository().extensions().filter(function(b){return a.repository().filterInstalled()&&!b.installed()||a.repository().filterUpdateRequired()&&!b.outdated()||a.repository().filterFavorited()&&!b.favorited()?!1:!0}).map(function(b){return d.component({extension:b,repository:a.repository,connected:a.connected})})])}}]);return k}(a);g("default",f)}}});"use strict";
System.register("flagrow/bazaar/components/BazaarPageHeader","flarum/app flarum/Component flarum/components/LinkButton flarum/components/Button flagrow/bazaar/modals/FilePermissionsModal flagrow/bazaar/modals/MemoryLimitModal flagrow/bazaar/modals/BazaarConnectModal".split(" "),function(g,l){var a,c,d,b,e,h,f,k;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]},function(a){f=
a["default"]}],execute:function(){k=function(c){function n(){babelHelpers.classCallCheck(this,n);return babelHelpers.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}babelHelpers.inherits(n,c);babelHelpers.createClass(n,[{key:"view",value:function(){return m("div",{className:"ExtensionsPage-header"},m("div",{className:"container"},this.header()))}},{key:"header",value:function(){var a=[].concat(this.requirementsButtons(),this.connectedButtons(),this.pagesButtons());
return m("div",{className:"ButtonGroup"},a)}},{key:"requirementsButtons",value:function(){var d=a.data.settings["flagrow.bazaar.php.memory_limit"],n=a.data.settings["flagrow.bazaar.php.memory_requested"],c=a.data.settings["flagrow.bazaar.file-permissions"]||[],k=[];a.data.settings["flagrow.bazaar.php.memory_limit-met"]||k.push(b.component({className:"Button Button--icon Requirement-MemoryLimit",icon:"signal",onclick:function(){return a.modal.show(new h({memory_requested:n,memory_limit:d}))}}));0<
c.length&&k.push(b.component({className:"Button Button--icon Requirement-FilePermissions",icon:"hdd-o",onclick:function(){return a.modal.show(new e({file_permissions:c}))}}));return k}},{key:"connectedButtons",value:function(){var e=a.data.settings["flagrow.bazaar.flagrow-host"]||"https://flagrow.io";return this.props.connected?[b.component({className:"Button Button--icon Connected",icon:"dashboard",onclick:function(){return window.open(e+"/home")}})]:[b.component({className:"Button Button--icon Connect",
icon:"plug",onclick:function(){return a.modal.show(new f({flagrowHost:e}))}})]}},{key:"pagesButtons",value:function(){if("undefined"===typeof a.current)return null;var b=a.current.props.routeName,e=[];"flagrow-bazaar"!==b&&e.push(d.component({className:"Button Button--icon",icon:"shopping-bag",href:a.route("flagrow-bazaar"),title:a.translator.trans("flagrow-bazaar.admin.header.extensions")}));"flagrow-bazaar-tasks"!==b&&e.push(d.component({className:"Button Button--icon",icon:"history",href:a.route("flagrow-bazaar-tasks"),
title:a.translator.trans("flagrow-bazaar.admin.header.tasks")}));return e}}]);return n}(c);g("default",k)}}});"use strict";
System.register("flagrow/bazaar/components/CustomCheckbox",["flarum/components/Checkbox","flarum/components/LoadingIndicator","flarum/helpers/icon"],function(g,l){var a,c,d,b;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){b=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);babelHelpers.createClass(b,
[{key:"getDisplay",value:function(){var a=this.props.iconChecked||"check",b=this.props.iconUnchecked||"times";return this.loading?c.component({size:"tiny"}):d(this.props.state?a:b)}}]);return b}(a);g("default",b)}}});"use strict";
System.register("flagrow/bazaar/components/ExtensionListItem","flarum/Component flarum/helpers/icon flarum/utils/ItemList flarum/components/Button flarum/components/Dropdown flarum/components/Badge".split(" "),function(g,l){var a,c,d,b,e,h,f;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]}],execute:function(){f=function(a){function k(){babelHelpers.classCallCheck(this,
k);return babelHelpers.possibleConstructorReturn(this,(k.__proto__||Object.getPrototypeOf(k)).apply(this,arguments))}babelHelpers.inherits(k,a);babelHelpers.createClass(k,[{key:"config",value:function(a){a||this.props.extension.description()&&this.$(".ExtensionIcon").tooltip({container:"body"})}},{key:"view",value:function(){var a=this.props.extension,b=this.controlItems(a,this.props.connected||!1).toArray(),d=this.badges(a).toArray();return m("li",{className:"ExtensionListItem "+(a.enabled()?"enabled ":
"disabled ")+(a.installed()?"installed ":"uninstalled ")+(a.outdated()?"outdated ":"")},m("div",{className:"ExtensionListItem-content"},m("span",{className:"ExtensionListItem-icon ExtensionIcon",style:a.icon()||"",title:a.description()},a.icon()?c(a.icon().name):""),m("ul",{className:"ExtensionListItem-badges badges"},d),b.length?m(e,{className:"ExtensionListItem-controls",buttonClassName:"Button Button--icon Button--flat",menuClassName:"Dropdown-menu--right",icon:"ellipsis-h"},b):"",m("label",{className:"ExtensionListItem-title"},
a.title()||a["package"]()),m("label",{className:"ExtensionListItem-vendor"},app.translator.trans("flagrow-bazaar.admin.page.extension.vendor",{vendor:a["package"]().split("/")[0]})),m("div",{className:"ExtensionListItem-version"},a.installed_version()||a.highest_version())))}},{key:"controlItems",value:function(a,e){var c=new d,h=this.props.repository,k=a.favorited()?"flagrow-bazaar.admin.page.button.remove_favorite_button":"flagrow-bazaar.admin.page.button.favorite_button";e&&c.add("favorite",b.component({icon:"heart",
children:app.translator.trans(k),onclick:function(){h().favoriteExtension(a)}}));a.enabled()&&app.extensionSettings[name]&&c.add("settings",b.component({icon:"cog",children:app.translator.trans("core.admin.extensions.settings_button"),onclick:app.extensionSettings[name]}));a.installed()&&!a.enabled()&&(c.add("uninstall",b.component({icon:"minus-square-o",children:app.translator.trans("flagrow-bazaar.admin.page.button.uninstall"),onclick:function(){h().uninstallExtension(a)}})),c.add("enable",b.component({icon:"check-square-o",
children:app.translator.trans("flagrow-bazaar.admin.page.button.enable"),onclick:function(){h().enableExtension(a)}})));a.installed()&&a.outdated()&&c.add("update",b.component({icon:"toggle-up",children:app.translator.trans("flagrow-bazaar.admin.page.button.update"),onclick:function(){h().updateExtension(a)}}));a.installed()&&a.enabled()&&c.add("disable",b.component({icon:"square-o",children:app.translator.trans("flagrow-bazaar.admin.page.button.disable"),onclick:function(){h().disableExtension(a)}}));
a.installed()||c.add("install",b.component({icon:"plus-square-o",children:app.translator.trans("flagrow-bazaar.admin.page.button.install"),onclick:function(){h().installExtension(a)}}));return c}},{key:"badges",value:function(a){var b=new d;a.installed()&&a.outdated()&&b.add("favorited",m(h,{icon:"warning",type:"outdated",label:app.translator.trans("flagrow-bazaar.admin.page.extension.outdated",{"new":a.highest_version()})}));a.favorited()&&b.add("favorited",m(h,{icon:"heart",type:"favorited",label:app.translator.trans("flagrow-bazaar.admin.page.extension.favorited")}));
a.installed()&&!a.enabled()&&b.add("installed",m(h,{icon:"plus-square",type:"installed",label:app.translator.trans("flagrow-bazaar.admin.page.extension.installed")}));a.enabled()&&b.add("enabled",m(h,{icon:"check-square",type:"enabled",label:app.translator.trans("flagrow-bazaar.admin.page.extension.enabled")}));return b}}]);return k}(a);g("default",f)}}});"use strict";
System.register("flagrow/bazaar/components/TaskListItem","flarum/app flarum/Component flarum/helpers/icon flarum/components/Button flarum/helpers/humanTime flarum/helpers/fullTime".split(" "),function(g,l){var a,c,d,b,e,h,f;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]}],execute:function(){f=function(c){function f(){babelHelpers.classCallCheck(this,f);return babelHelpers.possibleConstructorReturn(this,
(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}babelHelpers.inherits(f,c);babelHelpers.createClass(f,[{key:"init",value:function(){this.extended=m.prop(!1)}},{key:"view",value:function(){var c=this,f=this.props.task,k=function(){switch(f.status()){case "success":return"check";case "exception":return"exclamation";case "working":return"spinner"}return"clock-o"}();return m("tbody",{className:"TaskListItem status-"+f.status()},m("tr",null,m("td",{className:"time-column"},e(f.created_at())),
m("td",{className:"status-column",title:a.translator.trans("flagrow-bazaar.admin.page.task.status."+(null!==f.status()?f.status():"unknown"))},m("div",{className:"status"},d(k))),m("td",{className:"command-column"},a.translator.trans("flagrow-bazaar.admin.page.task.command."+f.command(),{extension:m("strong",null,f["package"]())})),m("td",{className:"details-column"},b.component({icon:"plus",className:"Button",onclick:function(){c.extended(!c.extended())}}))),this.extended()?m("tr",null,m("td",{className:"output-column",
colspan:"4"},m("dl",null,m("dt",null,a.translator.trans("flagrow-bazaar.admin.page.task.attribute.created_at")),m("dd",null,h(f.created_at()))),m("dl",null,m("dt",null,a.translator.trans("flagrow-bazaar.admin.page.task.attribute.started_at")),m("dd",null,h(f.started_at()))),m("dl",null,m("dt",null,a.translator.trans("flagrow-bazaar.admin.page.task.attribute.finished_at")),m("dd",null,h(f.finished_at()))),m("p",null,a.translator.trans("flagrow-bazaar.admin.page.task.header.output")),m("pre",{className:"output"},
f.output()))):null)}}]);return f}(c);g("default",f)}}});"use strict";
System.register("flagrow/bazaar/components/TasksPage","flarum/app flarum/Component flagrow/bazaar/utils/TaskRepository flagrow/bazaar/components/BazaarPageHeader flagrow/bazaar/components/TaskListItem flagrow/bazaar/components/BazaarLoader".split(" "),function(g,l){var a,c,d,b,e,h,f;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]}],execute:function(){f=function(c){function f(){babelHelpers.classCallCheck(this,
f);return babelHelpers.possibleConstructorReturn(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}babelHelpers.inherits(f,c);babelHelpers.createClass(f,[{key:"init",value:function(){a.current=this;this.loading=m.prop(!1);this.repository=new d(this.loading);this.repository.loadNextPage();this.loader=h.component({loading:this.loading})}},{key:"view",value:function(){return m("div",{className:"ExtensionsPage Bazaar TaskPage"},b.component(),m("div",{className:"ExtensionsPage-list"},
m("div",{className:"container"},this.taskGroups().map(function(b){return b.tasks.length?m("div",null,m("h2",null,b.title),m("table",{className:"TaskPage-table"},m("thead",null,m("tr",null,m("th",{className:"time-column"},a.translator.trans("flagrow-bazaar.admin.page.task.header.time")),m("th",{className:"status-column"},a.translator.trans("flagrow-bazaar.admin.page.task.header.status")),m("th",null,a.translator.trans("flagrow-bazaar.admin.page.task.header.command")),m("th",{className:"details-column"},
a.translator.trans("flagrow-bazaar.admin.page.task.header.details")))),b.tasks.map(function(a){return m(e,{task:a})}))):null}))),this.loader)}},{key:"taskGroups",value:function(){var b=[{title:a.translator.trans("flagrow-bazaar.admin.page.task.group.today"),tasks:[]},{title:a.translator.trans("flagrow-bazaar.admin.page.task.group.lastmonth"),tasks:[]},{title:a.translator.trans("flagrow-bazaar.admin.page.task.group.older"),tasks:[]}],e=0,c=(new Date).setHours(0,0,0,0);this.repository.tasks().forEach(function(a){var d=
(new Date(a.created_at())).setHours(0,0,0,0);switch(e){case 0:d===c?b[e].tasks.push(a):e++;break;case 1:30>=(c-d)/864E5?b[e].tasks.push(a):e++;break;default:b[e].tasks.push(a)}});return b}}]);return f}(c);g("default",f)}}});"use strict";
System.register("flagrow/bazaar/main","flarum/extend flarum/app flagrow/bazaar/modals/BazaarSettingsModal flagrow/bazaar/models/Extension flagrow/bazaar/models/Task flagrow/bazaar/addBazaarPage flagrow/bazaar/addTasksPage".split(" "),function(g,l){var a,c,d,b,e,h;return{setters:[function(a){},function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){b=a["default"]},function(a){e=a["default"]},function(a){h=a["default"]}],execute:function(){a.initializers.add("flagrow-bazaar",
function(a){a.extensionSettings["flagrow-bazaar"]=function(){return a.modal.show(new c)};a.store.models["bazaar-extensions"]=d;a.store.models["bazaar-tasks"]=b;e();h()})}}});"use strict";
System.register("flagrow/bazaar/modals/BazaarConnectModal",["flarum/components/Modal","flarum/components/Button"],function(g,l){var a,c,d;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]}],execute:function(){d=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);babelHelpers.createClass(b,[{key:"className",value:function(){return"FilePermissionsModal"}},
{key:"title",value:function(){return app.translator.trans("flagrow-bazaar.admin.modal.connect-bazaar.title")}},{key:"content",value:function(){return m("div",{className:"Modal-body"},[m("p",app.translator.trans("flagrow-bazaar.admin.modal.connect-bazaar.description",{host:this.props.flagrowHost})),m("div",{className:"App-primaryControl"},[c.component({type:"submit",className:"Button Button--primary Button--block",disabled:!1,icon:"check",children:app.translator.trans("flagrow-bazaar.admin.page.button.connect")})])])}},
{key:"connect",value:function(){var a=window.open();app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/bazaar/connect"}).then(function(b){b&&b.redirect?a.location=b.redirect:a.close()})}},{key:"onsubmit",value:function(){this.connect()}}]);return b}(a);g("default",d)}}});"use strict";
System.register("flagrow/bazaar/modals/BazaarSettingsModal",["flarum/app","flarum/components/SettingsModal"],function(g,l){var a,c,d;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]}],execute:function(){d=function(b){function e(){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}babelHelpers.inherits(e,b);babelHelpers.createClass(e,[{key:"title",value:function(){return a.translator.trans("flagrow-bazaar.admin.modal.settings.title")}},
{key:"form",value:function(){return[m("div",{className:"Form-group"},[m("label",{"for":"bazaar-api-token"},a.translator.trans("flagrow-bazaar.admin.modal.settings.field.apiToken")),m("input",{id:"bazaar-api-token",className:"FormControl",bidi:this.setting("flagrow.bazaar.api_token")}),m("span",a.translator.trans("flagrow-bazaar.admin.modal.settings.field.apiTokenDescription"))])]}}]);return e}(c);g("default",d)}}});"use strict";
System.register("flagrow/bazaar/modals/FilePermissionsModal",["flarum/components/Modal"],function(g,l){var a,c;return{setters:[function(c){a=c["default"]}],execute:function(){c=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);babelHelpers.createClass(b,[{key:"className",value:function(){return"FilePermissionsModal"}},{key:"title",value:function(){return app.translator.trans("flagrow-bazaar.admin.modal.requirements.file-permissions.title")}},
{key:"content",value:function(){var a=[];this.props.file_permissions.forEach(function(b){a.push(m("li",m("span",{className:"code"},b)))});return m("div",{className:"Modal-body"},[m("p",app.translator.trans("flagrow-bazaar.admin.modal.requirements.file-permissions.description",{a:m("a",{href:"https://github.com/flagrow/bazaar/wiki/File-permissions",target:"_blank"})})),m("ul",a)])}}]);return b}(a);g("default",c)}}});"use strict";
System.register("flagrow/bazaar/modals/MemoryLimitModal",["flarum/components/Modal"],function(g,l){var a,c;return{setters:[function(c){a=c["default"]}],execute:function(){c=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);babelHelpers.createClass(b,[{key:"className",value:function(){return"MemoryLimitModal"}},{key:"title",value:function(){return app.translator.trans("flagrow-bazaar.admin.modal.requirements.php-memory_limit.title")}},
{key:"content",value:function(){return m("div",{className:"Modal-body"},app.translator.trans("flagrow-bazaar.admin.modal.requirements.php-memory_limit.description",{required:this.props.memory_requested,limit:this.props.memory_limit,a:m("a",{href:"https://github.com/flagrow/bazaar/wiki/PHP-memory-limit",target:"_blank"})}))}}]);return b}(a);g("default",c)}}});"use strict";
System.register("flagrow/bazaar/models/Extension",["flarum/Model","flarum/utils/mixin","flarum/utils/computed"],function(g,l){var a,c,d,b;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){b=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);return b}(c(a,{"package":a.attribute("package"),
title:a.attribute("title"),description:a.attribute("description"),license:a.attribute("license"),icon:a.attribute("icon"),stars:a.attribute("stars"),forks:a.attribute("forks"),downloads:a.attribute("downloads"),installed:a.attribute("installed"),enabled:a.attribute("enabled"),installed_version:a.attribute("installed_version"),highest_version:a.attribute("highest_version"),outdated:a.attribute("outdated"),flarum_id:a.attribute("flarum_id"),can_install:d("installed",function(a){return!a}),can_uninstall:d("installed",
"enabled",function(a,b){return a&&!b}),favorited:a.attribute("favorited")}));g("default",b)}}});"use strict";
System.register("flagrow/bazaar/models/Task",["flarum/Model","flarum/utils/mixin"],function(g,l){var a,c,d;return{setters:[function(b){a=b["default"]},function(a){c=a["default"]}],execute:function(){d=function(a){function b(){babelHelpers.classCallCheck(this,b);return babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}babelHelpers.inherits(b,a);return b}(c(a,{status:a.attribute("status"),command:a.attribute("command"),"package":a.attribute("package"),
output:a.attribute("output"),created_at:a.attribute("created_at"),started_at:a.attribute("started_at"),finished_at:a.attribute("finished_at")}));g("default",d)}}});"use strict";
System.register("flagrow/bazaar/utils/ExtensionRepository",["flarum/app"],function(g,l){var a,c;return{setters:[function(c){a=c["default"]}],execute:function(){c=function(){function c(a){babelHelpers.classCallCheck(this,c);this.extensions=m.prop([]);this.nextPageUrl=null;this.loading=a;this.resetNavigation();this.searchTerm=m.prop("");this.filterInstalled=m.prop(!1);this.filterUpdateRequired=m.prop(!1);this.filterFavorited=m.prop(!1)}babelHelpers.createClass(c,[{key:"loadNextPage",value:function(){var b=
this;if(!this.loading()&&this.nextPageUrl){this.loading(!0);var c={filter:{}};this.searchTerm()&&(c.filter={search:this.searchTerm()});a.request({method:"GET",url:this.nextPageUrl,data:c}).then(function(c){var e=c.data.map(function(b){return a.store.createRecord("bazaar-extensions",b)});b.extensions(e);b.nextPageUrl=c.links.next;b.loading(!1);m.redraw()})}}},{key:"resetNavigation",value:function(){this.loading(!1);this.nextPageUrl=a.forum.attribute("apiUrl")+"/bazaar/extensions";this.extensions([])}},
{key:"installExtension",value:function(b){var c=this;this.loading(!0);a.request({method:"POST",url:a.forum.attribute("apiUrl")+"/bazaar/extensions",timeout:0,data:{id:b.id()}}).then(function(a){c.updateExtensionInRepository(a)})}},{key:"installFailure",value:function(a){this.resetNavigation();this.loadNextPage()}},{key:"uninstallExtension",value:function(b){var c=this;this.loading(!0);a.request({method:"DELETE",timeout:0,url:a.forum.attribute("apiUrl")+"/bazaar/extensions/"+b.id()}).then(function(a){c.updateExtensionInRepository(a)})}},
{key:"uninstallFailure",value:function(a){this.resetNavigation();this.loadNextPage()}},{key:"favoriteExtension",value:function(b){var c=this;this.loading(!0);a.request({method:"post",url:a.forum.attribute("apiUrl")+"/bazaar/extensions/"+b.id()+"/favorite",data:{favorite:1!=b.favorited()}}).then(function(a){c.updateExtensionInRepository(a)})}},{key:"updateExtension",value:function(b){var c=this;this.loading(!0);a.request({url:a.forum.attribute("apiUrl")+"/bazaar/extensions/"+b.id(),timeout:0,method:"PATCH"}).then(function(a){c.updateExtensionInRepository(a)}).then(function(){location.reload()})}},
{key:"toggleExtension",value:function(b){var c=this;this.loading(!0);var d=b.enabled();a.request({url:a.forum.attribute("apiUrl")+"/bazaar/extensions/"+b.id()+"/toggle",method:"PATCH",data:{enabled:!d}}).then(function(a){c.updateExtensionInRepository(a)})}},{key:"disableExtension",value:function(a){this.toggleExtension(a)}},{key:"enableExtension",value:function(a){this.toggleExtension(a)}},{key:"getExtensionIndex",value:function(a){return this.extensions().findIndex(function(b){return b.id()==a.id()})}},
{key:"updateExtensionInRepository",value:function(b){this.loading(!1);b=a.store.createRecord("bazaar-extensions",b.data);this.extensions()[this.getExtensionIndex(b)]=b;m.redraw()}},{key:"search",value:function(a){this.searchTerm(a);this.resetNavigation();this.loadNextPage()}}]);return c}();g("default",c)}}});"use strict";
System.register("flagrow/bazaar/utils/TaskRepository",["flarum/app"],function(g,l){var a,c;return{setters:[function(c){a=c["default"]}],execute:function(){c=function(){function c(a){babelHelpers.classCallCheck(this,c);this.tasks=m.prop([]);this.nextPageUrl=null;this.loading=a;this.resetNavigation()}babelHelpers.createClass(c,[{key:"loadNextPage",value:function(){var b=this;!this.loading()&&this.nextPageUrl&&(this.loading(!0),a.request({method:"GET",url:this.nextPageUrl}).then(function(c){c=c.data.map(function(b){return a.store.createRecord("bazaar-tasks",
b)});b.tasks(c);b.nextPageUrl=null;b.loading(!1);m.redraw()}))}},{key:"resetNavigation",value:function(){this.loading(!1);this.nextPageUrl=a.forum.attribute("apiUrl")+"/bazaar/tasks";this.tasks([])}}]);return c}();g("default",c)}}});";